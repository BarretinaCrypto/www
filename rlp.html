<h3>Specification: Recursive Length Prefix Encoding</h3>

<p>Recursive length prefix encoding is a way of serializing data into the form of a string. RLP encoding can encode either strings or arrays of arbitrary length, dimension and depth; associative arrays are not natively supported. RLP encoding is defined in two parts. First, we define a method called <code>num_to_var_int</code> which converts a number into 1-9 bytes using a prefix-free encoding - that is, given the start of a <code>var_int</code> there is only one place that <code>var_int</code> could end. If the integer is below 253, the <code>var_int</code> is just the corresponding byte; otherwise, depending on the integer's size, the integer is stored in 2-byte, 4-byte or 8-byte binary form and an initial byte of 253, 254 or 255 is used to specify which length is used. Here is the definition in code:</p>

<pre><code>def to_binary(x,bytes):
    if bytes == 0:     return ''
    else:              return to_binary(int(x / 256), bytes - 1) + chr(x % 256)

def num_to_var_int(x):
    if x &lt; 253:        return chr(int)
    else if x &lt; 2**16: return chr(253) + to_binary(x,2)
    else if x &lt; 2**32: return chr(253) + to_binary(x,4)
    else:              return chr(253) + to_binary(x,8)
</code></pre>

<p>Examples:</p>

<pre><code>&gt; to_binary(128)
'\x80'
&gt; to_binary(252)
'\xfc'
&gt; to_binary(253)
'\xfd\x00\xfd'
&gt; to_binary(1024)
'\xfd\x04\x00'
&gt; to_binary(2147483647)
'\xfe\x7f\xff\xff\xff'
</code></pre>

<p>And now we define the actual <code>rlp_encode</code> method. The encoding is simple: for strings, it's just <code>'\x00' + num_to_var_int(s.length) + s</code>, and for arrays we first recursively RLP encode each item in the array, then concatenate these encodings together, and take the RLP encoding of that as a string, but using <code>'\x01'</code> as the beginning byte instead of <code>'\x00'</code>. </p>

<pre><code>def rlp_encode(obj):
    if isinstance(obj,str):
        return '\x00' + num_to_var_int(len(obj)) + obj
    elif isinstance(obj,list):
        x = ''.join([rlp_encode(x) for x in obj])
        return '\x01' + num_to_var_int(len(x)) + x
</code></pre>

<p>Examples:</p>

<pre><code>&gt; rlp_encode('dog')
'\x00\x03dog'

&gt; rlp_encode(['dog','god','cat'])
'\x01\x0fx00\x03dog\x00\x03god\x00\x03cat'

&gt; rlp_encode([[['doge'],'dog'],'do'])
'\x01\x13\x01\x0d\x01\x06\x00\x04doge\x00\x03dog\x00\x02do'
</code></pre>
